% Relevant to me:

% $\int_A := \int_{inner} \int_{outer}$, defined for both forms $\Omega(A, L)$ and $\Omega(A)$ (for the decomposition? Or when is that used?). Used for below:

%     \begin{itemize}
    
%     \item For $\hat \omega \in \Omega^1(A, L)$, define $S_{Gauge}[\hat \omega] = (\hat R, \hat R) = \int_A h(\hat R, \star \hat R)$.
    
%     \item For $\phi \in \Gamma(E)$ and $\hat \omega$ as above, \[S_{Matter}[\phi, \hat \omega] := (\hat \nabla^E \phi, \hat \nabla^E \phi)\]
    
%     \end{itemize}
    
% That means the star is needed for: 
%     \begin{itemize}
        
%     \item $\star \hat R$, where $\hat R \in \Omega^2(A, L)$
    
%     \item $\star \hat \nabla^E \phi$ for $\hat \nabla^E \phi \in \Omega^1(A, E)$
    
%     \item Some other forms of the same type that are generated by the decomposition
        
%     \end{itemize}

{
\color{gray}
    Outline:
    
    \begin{itemize}
    
    \item Inner Metrics and Metrics on Representation Vector Bundle of Transitive Lie Algebroids
    
        \begin{itemize}
            
        \item $h^E$ on $E$ symmetric bilinear form.
        
            \begin{itemize}
                
            \item e.g. Defn: inner metric
            
            \item $h^E_{uv}$
            
            \item $h^E_i = G \, G h^E_j$
                
            \end{itemize}
        
        \item $h^E$ on $\Omega^\bullet (A, E)$.
            
            \begin{itemize}
                
            \item $h^E(\alpha, \beta) = \alpha^u \wedge \beta^v h_{uv}$ (or, slightly more generally, multiplicatio by $0$ form gets out with $h$)
                
            \end{itemize}
            
        \item $\phi_L$-compatible $E$-metric: $h^E(\phi_L(\eta) \mu_1, \mu_2) + h^E(\mu_1, \phi_L(\eta)\mu_2) = 0$
        
            \begin{itemize}
                
            \item e.g. Defn: Killing metric
                
            \end{itemize}
        
        \item (Needed?) Locally constant metric. Compatible with $d$'s.
        
        \end{itemize}
    
    \item Symmetric Bilinear forms on Transitive Lie Algebroids
    
        \begin{itemize}
            
        \item $\hat g \to h$. Defn: Inner part
        
            \begin{itemize}
                
            \item Defn: Inner nondegenerate metric on $A$
                
            \end{itemize}
        
        \item $g \to \hat g$. Null inner part
        
        Let $\nabla$ be an ordinary connection on $A$. Then:
        
        \item $h \to \hat g$
        
        \item $\hat g \to g$
            
        \item Theorem: Inner nondegenerate bilsymform iff $(g, h, \nabla)$ with $h$ nondeg. (i.e. actual metric) and $\nabla$ ordinary connection. Proof: Adaptation of Riesz representatio theorem (of Hilbert spaces, say).
        
        Such $\hat g \equiv (g, h, \nabla)$ assumed from now on.
        
        \item Local:
        
            \begin{itemize}
                
            \item $\hat g = g_{\mu \nu} dx^\mu dx^\nu + h_{ab} \alg a^a \alg a^b$
                
            \end{itemize}
        
        \end{itemize}
    
    \item Inner Orientability and Orientability
    
        \begin{itemize}
            
        \item Defn: inner orientable transitive LAoid. Suppose basis such that $|G| \geq 0$
        
        From now on $\hat g \equiv (g, h, \nabla)$ (inner n.d.) and inner orientable
        
        \item Defn: Inner volume form $\omega_{h, \alg a}$. Exists globally since it transforms well.
        
        \item Inner integration:
        
            \begin{itemize}
                
            \item (needed?) Of $L$-valued forms
            
            \item of $\bb K$-valued forms
            
            \item It is the factor of $\sqrt{|h|} \epsilon^1 \wedge \cdots \wedge \epsilon^n$. In particular, it doesn't actually depend on $\nabla$ (nor $g$), only on $h$.
                
            \end{itemize}
        
        --------------
        
        \item Defn: Orientable. From now on $\hat g \equiv (g, h, \nabla)$ (inner n.d.) and orientable.
        
        \item Defn: Integration on $A$: $\Omega^\bullet(A) \to \bb K$ ONLY (or at least all what we need)
        
        \item Defn: $\langle , \rangle \to \bb K := \int _A h^E(\cdot, \cdot)$ of $E$-valued forms given $h^E$ metric. Nondeg. since $h^E$ nondeg.
        
        \end{itemize}
    
    \item Horizontal Metrics and Hodge-$*$ Operator
    
    From now on $\hat g \equiv (g, h, \nabla)$ and orientable and nondegenerate i.e. $\hat g$ a metric on $A$ and $A$ orientable.
    
        \begin{itemize}
            
        \item Defn: volume form. Never $0$.
        
        \item Defn: $\hat g^{-1}(\alpha, \beta) \in C^\infty(M)$ for $\alpha, \beta \in  \Omega^p(A)$. Then:
        
        \item Defn: $\hat g^{-1}_{h^E}(\alpha, \beta) \in C^\infty(M)$ for $\alpha, \beta \in \Omega^p(A, E)$ given $E$-metric (i.e. nondeg.) $h^E$.
        
            \begin{itemize}
                
            \item Locally: $\hat g^{-1}_{h^E}(\alpha, \beta) = (h^E)_{uv} g^{\mu_1 \nu_2} \cdots h^{a_s b_s} \alpha^u_{\mu_1 \dots a_s} \beta^v_{\nu_1 \dots b_s} $ 
            
            \item Then define $\beta^\# = \beta_u^{\mu_1 \dots a_s} \tilde e^u \nabla_{\mu_1}\wedge \cdots \wedge (-E_{a_s}) \in \Omega^{p*}_{U_i}(A, E)$ where $\beta_u^{\mu_1 \dots a_s} := (h^E)_{uv} g^{\mu_1 \nu_2} \cdots h^{a_s b_s} \beta^v_{\nu_1 \dots b_s}$. Pretty sure it transforms well TODO. Then $\hat g^{-1}_{h^E}(\alpha, \beta) = \alpha^a_{\mu_1 \dots a_s} \beta_a^{\mu_1 \dots a_s}$.
                
            \end{itemize}
        
        \item Hodge-$*$ of $E$-valued forms: Defined such that $h^E(\alpha, *\beta) = \hat g^{-1}_{h^E}(\alpha, \beta) vol$
        
            \begin{itemize}
                
            \item In particular, for $\bb K$-valued: $\alpha \wedge *\beta =\hat g^{-1}(\alpha, \beta) vol$
                
            \end{itemize}
        Given by formula $2.6$: $\cdots$. Easy to transforms well, so it is globally defined.
        
        \item Defn: $(,): \Omega^p(A, E) \times \Omega^p(A, E) \to \bb K := \langle \cdot , * \cdot \rangle = \int_A h^E(\cdot, * \cdot)$.
        
        \item Theorem: In a trivialization of $A$:
        \begin{equation}
            (\alpha, \beta) = (-1)^n \int_M \sqrt{|g|} dx^1 \wedge \cdots \wedge dx^m \sum_{r + s = p} (-1)^{s(m-s)} (m-r)! (n-s)! \times \alpha^a_{\mu_1 \dots a_s} \beta_a^{\mu_1 \dots a_s}.
        \end{equation}
            
        \end{itemize}
        
    \end{itemize}

}

The formulation of a gauge theory on a transitive Lie algebroid $A$ will be made through the action functional $S[\phi, \hat \omega]$ of the theory, which will be the spacetime integral of the Lagrangian density, which is, in turn, the inner integral (definition \ref{}) of a scalar valued form on $A$, a form found as the a product of vector valued forms induced by a metric on the representation vector bundle.

Let every vector space, and hence every vector bundle, be over the field $\bb K$, where $\bb K$ is one of $\RR$ or $\CC$. Throughout this chapter let $0 \to L \xrightarrow{j} A \xrightarrow{a} TM$ be a transitive Lie algebroid for the transitive Lie algebroid $A$ over the manifold $M$.

(Assume $M$ is connected and) let $\{\}$ be a Lie algebroid atlas for $A$, where $\alg g$ is a Lie algebra\todo{I'm not sure I have been careful with the single typical fiber thing.} with basis $\{E_a\}_{a = 1, \dots, n}$ and associated dual basis $\{\epsilon^a\}_{a = 1, \dots, n}$.

Also, let $E$ be a vector bundle over $M$ on which $A$ is represented by $\phi: A \to \alg D(E)$, with vertical component $\phi_L: L \to \End(E)$. Suppose that $E$ is trivialized over each $U_i$, $i \in I$, by the vector bundle isomorphisms $\beta_i: U_i \times V \to E|_U$, where $V$ is a vector space with basis $\{e_u\}_{u = 1, \dots, t}$ and associated dual basis $\{\tilde e_u\}_{u = 1, \dots, t}$.\todo{Take this as example for all previous instances of this concepts and their labels}.

\section{Degenerate Metrics on Representation Vector Bundles and Inner Metrics}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{definition}
    Let $E$ be any vector bundle over $M$. \emph{A degenerate metric on $E$} on $E$ is a symmetric vector bundle map $h^E: E \otimes E \to \bb K$. If $h^E$ is non-degenerate, i.e. if $h^E(\mu, \mu) = 0$, only if $\mu = 0$, then $h^E$ is called \emph{a metric on $E$}.
    
    In the case that $E = L$ the adjoint Lie algebroid of $A$, we also use the names \emph{degenerate inner metric on $A$} and \emph{inner metric on $A$}, respectively.
\end{definition}

Notice that a (degenerate) metric on $E$ is equivalent to a $C^\infty(M)$-linear map $h^E: \Gamma(E) \otimes \Gamma(E) \to C^\infty(M)$ which is a field of symmetric bilinear forms if $h^E$ is degenerate, and a field of metrics in the non-degenerate case. We now return to consider $E$ as a representation vector bundle of $A$.

For the rest of the chapter, let $h^E$ be a degenerate metric on $E$ and let $h$ be a degenerate inner metric on $A$.

\begin{definition}
    Over the trivializing neighborhood $U_i$, \emph{the components of $h^E$ with respect to the basis $\{e_u\}$}, with $u, v = 1, \dots$, are the functions $h^{E, i}_{u, v}:= h^E|_{U_i}(\beta_i(e_u),\beta_i(e_v)) \in C^\infty(U_i)$, where $e_u$ and $e_v$ are the corresponding constant $V$-valued functions on $U_i$.
\end{definition}

In particular, $h_{ab}$ are the components of $h$ with respect to the basis $\{E_a\}$, $a, b = 1, \dots, n$. Notice that, in contrast to the components of forms, the components of a (degenerate) metric are symmetric on the indices.

\begin{proposition}
Let ${H^i_j}^u_v = \tilde e^u(\beta^i_j(e_v))$, for $i, j \in I$ and $u, v \in \{1, \dots, t\}$ be the matrix representation of the transition function of $E$ from $U_j$ to $U_i$. Then,
\begin{equation}
    h^{E, j}_{u_1 u_2} = {H^i_j}^{v_1}_{u_1}{H^i_j}^{v_2}_{u_2} h^{E, i}_{v_1 v_2}
\end{equation}
for $u_1, u_2, v_1, v_2 \in \{1, \dots, t\}$.
\end{proposition}
\begin{proof}
\begin{align*}
    h^{E, j}_{u_1 u_2} 
        &= h^E(\beta_j(e_{u_1}),\beta_j(e_{u_2})) \\
        &= h^E(\beta_i \comp \beta^i_j(e_{u_1}), \beta_i \comp \beta^i_j(e_{u_2})\\
        &= h^E({H^i_j}^{v_1}_{u_1} \beta_i(e_{u_2}), {H^i_j}^{v_1}_{u_1} \beta_i(e_{u_2}))
        &= {H^i_j}^{v_1}_{u_1}{H^i_j}^{v_2}_{u_2} h^{E, i}_{v_1 v_2}
\end{align*}
\end{proof}
Recall that the transition functions of $L$ are denoted by $\alpha^i_j$ and its matrix representation with respect to $\{E_a\}_{a = 1, \dots, n}$ is denoted by ${G^i_j}^a_b$.

\begin{definition}
    Given a degenerate metric on the representation vector bundle $E$ of $A$, let
    \begin{equation}
        h^E: \Omega^p(A, E) \otimes \Omega^q(A, E) \to \Omega^{p+q}(A)
    \end{equation}
    for all $p, q \in \ZZ_{\geq 0}$ be the skew-symmetric $C^\infty(M)$-linear (family of) map defined by
    \begin{eqnsplit}
        h^E(\omega, \eta)(\oid X_1, \dots, \oid X_{p+q}) := \frac{1}{p!q!} \sum_{\sigma \in Sym_{p+q}} 
        h^E\left( \omega(\oid X_{\sigma(1)}, \dots, \oid X_{\sigma(p)}),  \eta(\oid X_{\sigma(p+1)}, \dots, \oid X_{\sigma_{p+q}}) \right),
    \end{eqnsplit}
    for all $\omega \in \Omega^p(A, E)$, $\eta \in \Omega^q(A, E)$, and $\oid X_1, \dots, \oid X_{p+q} \in A$.
\end{definition}

\begin{proposition}
Let $\alpha, \beta \in \Omega_{U_i}^\bullet(A)$, and let $\mu_1, \nu \in \Gamma_{U_i}(E) = \Omega^0_{U_i}(A, E)$. Then
\begin{equation}
    h^E(\mu \alpha, \nu \beta) = h^E(\mu, \nu) \, \alpha \wedge \beta.
\end{equation}
\end{proposition}
\begin{proof}
This is a direct consequence of the bilinearity of $h^E$  and how the formula for $h^E$ applied to forms is a generalization of the formula for the wedge product.
\begin{align*}
    h^E(\mu \alpha, \nu \beta)&(\oid X_1, \dots, \oid X_{p+q})\\
    &=\frac{1}{p!q!} \sum_{\sigma \in Sym_{p+q}} h^E\left( \mu \omega(\oid X_{\sigma(1)}, \dots, \oid X_{\sigma(p)}),  \nu \eta(\oid X_{\sigma(p+1)}, \dots, \oid X_{\sigma_{p+q}}) \right) \\
    &= \frac{1}{p!q!} \sum_{\sigma \in Sym_{p+q}} 
        h^E\left( \mu ,  \nu  \right) 
        \omega(\oid X_{\sigma(1)}, \dots, \oid X_{\sigma(p)}) \eta(\oid X_{\sigma(p+1)}, \dots, \oid X_{\sigma_{p+q}})\\
    &= h^E(\mu, \nu) \, (\omega \wedge \eta)(\oid X_1, \dots, \oid X_{p+q}).
\end{align*}
\end{proof}

The previous proposition may be applied to the components of $E$-valued forms on each $U_i$ with respect to the basis $\{e_u\}$, since then $\omega = \omega^u e_u$ and $\eta = \eta^v e_v$ with $\omega^u$ and $\eta^v$ are scalar valued forms; hence
\begin{equation}
    h^E|_{U_i}(\omega, \eta) = h^{E,i}_{uv}\,\omega^u \wedge \eta^v 
\end{equation}

\begin{definition}
A degenerate metric $h^E$ on $E$ is called \emph{compatible with the representation} if
\begin{equation*}
    h^E(\phi_L(\eta) \mu_1, \mu_2) + h^E(\mu_1, \phi_L(\eta)\mu_2) = 0,
\end{equation*}
for all $\eta \in L_m$ and $\mu_1, \mu_2 \in E_m$ for all $m \in M$.

In the case that $E$ is the adjoint Lie algebroid $L$, we also say that \emph{$h$ is a Killing degenerate metric}.
\end{definition}

Since the representation of $A$ on $L$ is is the adjoint representation, a Killing inner (degenerate) metric $h$ satisfies, for all $m \in M$, $\eta, \theta, \gamma \in L_m$:
\begin{equation}
    h([\eta, \theta], \gamma) = h(\theta, [\eta, \gamma]) = 0.
\end{equation}

\section{Degenerate Metrics}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{definition}
\emph{The inner part of $\hat g$} is the degenerate inner metric \begin{equation}
    h := j^*g.
\end{equation} If $h$ is non-degenerate, $\hat g$ is called \emph{an inner non-degenerate metric on $A$}.
\end{definition}

Let $g$ be a (degenerate) metric on $TM$, i.e. a (degenerate) metric on $M$, then we may define a degenerate metric $\hat g$ on $A$ by
\begin{equation}
    \hat g = a^* g;
\end{equation}
this is a degenerate metric on $A$ since its inner part is null.

\begin{definition}
Let $\nabla: TM \to A$ be an ordinary connection on $A$ with induced connection form $\alg a \in \Omega^1(A, L)$. Then:
    \begin{itemize}
    
    \item Given an inner degenerate metric $h$ on $A$, \emph{the degenerate metric induced by $\nabla$} is
    \begin{equation}
        \hat g := \alg a^* h;
    \end{equation}
    this metric has $h$ as inner part.
    
    \item Given a degenerate metric $\hat g$ on $A$, \emph{the tangent degenerate metric induced by $\nabla$} is the degenerate metric $g$ on $TM$:
    \begin{equation}
        g := \nabla^* \hat g.
    \end{equation}
    
    \end{itemize}
\end{definition}

\begin{theorem}
An inner non-degenerate metric $\hat g$ on $A$ is equivalent to a triple $(g, h, \nabla)$ through the equation
\begin{equation}
    \hat g(\oid X, \oid Y) = g(a(\oid X), a(\oid Y)) + h(\alg a(\oid X), \alg a(\oid Y));
\end{equation}
where $g$ is a degenerate metric on $TM$, $h$ is an inner non-degenerate metric on $A$ and $\nabla$ is an ordinary connection on $A$ with associated connection $1$-form $\alg a$. In particular, $h$ is the inner part of $\hat g$ and $g$ is the tangent degenerate metric on $TM$ induced by the connection.
\end{theorem}
\begin{proof}
For a given triple $(g, h, \nabla)$, the corresponding degenerate metric is precisely $\hat g = a^*g + \alg a^* h$.

For the converse, let $\hat g$ be an inner non-degenerate metric on $A$. Then, let $h$ be the inner part of $\hat g$. We now need to see that an inner non-degenerate metric induces an ordinary connection $\nabla$ for which the vertical bundle of $A$ and the horizontal bundle induced by the connection are orthogonal, i.e. a connection such that
\begin{align}
    \hat g(\nabla_X, j(\eta)) &= 0,& \text{for all $X \in TM$ and $\eta \in L$};
\end{align} then, $g$ will simply be the tangent degenerate metric induced by $\hat g$. To prove this we follow an adapted version of Riesz representation theorem \todo{}.
\end{proof}


Suppose that on $U_i$ there is are coordinates $x^\mu: U_i \to \RR$ for $M$, with $\mu, \nu \in \{1, \dots, m\}$. Let $\hat g$ be an inner nondegenerate metric on $A$ associated to the triple $(g, h, \nabla)$. Then, with respect to the local frame $\{\nabla_\mu, -E_a\}$ of $A$ it is true that the following maps, called \emph{the local components of $\hat g$ with respect to the coordinates $x^\mu$ and the basis $\{E_a\}$} of $\alg g$, where $\mu, \nu = 1, \dots, m$ and $a, b = 1, \dots, n$, satisfy $\hat g_{\mu \nu} = \hat g(\nabla_\mu, \nabla_\nu) = \delta_{\mu \nu}$, $\hat g_{\mu a} = \hat g(\nabla_\mu, -E_a)=0$ and $\hat g_{ab} = \hat g(-E_a, -E_b) = \delta_{ab}$, i.e.
\begin{equation}
    \hat g = g_{\mu \nu} dx^\mu dx^\nu + h_{ab} \alg a^a \alg a^b
\end{equation}


\section{Inner Integration and Integration}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Horizontal Metrics and Hodge-$*$ Operator}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%